@inherits BunitContext

@code {

	public TreeView BookTreeView;

	System.Xml.XmlDocument bookXml = new System.Xml.XmlDocument();
	System.Diagnostics.Stopwatch stopwatch;
	long dataBindingTicks = 0;
	long dataBoundTicks = 0;

	[Fact]
	public void TreeView_XmlDataSource_FiresDataBindingEvents()
	{
		bookXml.LoadXml(@"<Book Title=""Book Title"" />");
		stopwatch = System.Diagnostics.Stopwatch.StartNew();

		var cut = Render(
			@<TreeView @ref="BookTreeView"
								DataSource="bookXml"
								OnDataBinding="OnDataBinding"
								OnDataBound="OnDataBound"
								runat="server">

				<DataBindings>
					<TreeNodeBinding DataMember="Book" TextField="Title" />
				</DataBindings>

			</TreeView>
		);

		var test = cut.Markup;

		stopwatch.Stop();

		dataBindingTicks.ShouldNotBe(0, "OnDataBinding event did not trigger");
		dataBoundTicks.ShouldNotBe(0, "OnDataBound event did not trigger");
		dataBoundTicks.ShouldBeGreaterThan(dataBindingTicks);
	}

	void OnDataBinding()
	{
		dataBindingTicks = stopwatch.ElapsedTicks;
	}

	void OnDataBound()
	{
		dataBoundTicks = stopwatch.ElapsedTicks;
	}

}
