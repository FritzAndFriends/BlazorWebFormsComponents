@page "/ControlSamples/GridView/Sorting"
@using BlazorWebFormsComponents.Enums
@using SharedSampleObjects.Models

<PageTitle>GridView - Sorting</PageTitle>

<h2>GridView - Sorting</h2>

<p>This sample demonstrates GridView with sorting enabled. Click a column header to sort by that column. Click again to toggle the sort direction.</p>

<Nav />

<GridView ItemType="Product" DataSource="@Products" AllowSorting="true" AutoGenerateColumns="false"
          Sorting="HandleSorting">
    <Columns>
        <BoundField ItemType="Product" DataField="Name" HeaderText="Name" />
        <BoundField ItemType="Product" DataField="Price" HeaderText="Price" DataFormatString="{0:C}" />
        <BoundField ItemType="Product" DataField="Category" HeaderText="Category" />
    </Columns>
</GridView>

<p>
    Sort Column: <strong>@(string.IsNullOrEmpty(CurrentSortExpression) ? "(none)" : CurrentSortExpression)</strong> |
    Sort Direction: <strong>@CurrentSortDirection</strong>
</p>

@code {
    private string CurrentSortExpression = "";
    private SortDirection CurrentSortDirection = SortDirection.Ascending;

    private List<Product> Products = new List<Product>();

    protected override void OnInitialized()
    {
        Products = Product.GetProducts(25);
    }

    private void HandleSorting(GridViewSortEventArgs e)
    {
        CurrentSortExpression = e.SortExpression;
        CurrentSortDirection = e.SortDirection;

        Products = e.SortExpression switch
        {
            "Name" => e.SortDirection == SortDirection.Ascending
                ? Products.OrderBy(p => p.Name).ToList()
                : Products.OrderByDescending(p => p.Name).ToList(),
            "Price" => e.SortDirection == SortDirection.Ascending
                ? Products.OrderBy(p => p.Price).ToList()
                : Products.OrderByDescending(p => p.Price).ToList(),
            "Category" => e.SortDirection == SortDirection.Ascending
                ? Products.OrderBy(p => p.Category).ToList()
                : Products.OrderByDescending(p => p.Category).ToList(),
            _ => Products
        };
    }
}
