@page "/ControlSamples/DetailsView"
@using BlazorWebFormsComponents
@using BlazorWebFormsComponents.Enums
@using SharedSampleObjects.Models

<PageTitle>DetailsView Sample</PageTitle>

<h2>DetailsView Component Samples</h2>

<p>The <code>DetailsView</code> control displays a single record from a data source in a table layout,
   with one row per field. In Web Forms this was <code>&lt;asp:DetailsView&gt;</code>.</p>

<hr />

<h3>Auto-Generated Rows</h3>
<p>When <code>AutoGenerateRows</code> is <code>true</code> (the default), the DetailsView
   automatically creates a row for each public property on the data item.</p>

<div data-audit-control="DetailsView-1">
<DetailsView ItemType="Product"
             Items="@_products"
             AutoGenerateRows="true"
             HeaderText="Product Details"
             GridLines="GridLines.Both" />
</div>

<p>Code:</p>
<pre><code>&lt;DetailsView ItemType="Product"
             Items="@@_products"
             AutoGenerateRows="true"
             HeaderText="Product Details"
             GridLines="GridLines.Both" /&gt;</code></pre>

<hr />

<h3>Paging Between Records</h3>
<p>Set <code>AllowPaging="true"</code> to display a pager row that lets users navigate
   between individual records in the data source — one record at a time.</p>

<div data-audit-control="DetailsView-2">
<DetailsView ItemType="Product"
             Items="@_products"
             AllowPaging="true"
             AutoGenerateRows="true"
             HeaderText="Browse Products"
             GridLines="GridLines.Both"
             PageIndexChanged="HandlePageChanged" />
</div>

<p>Current page changed <strong>@_pageChangeCount</strong> time(s).</p>

<p>Code:</p>
<pre><code>&lt;DetailsView ItemType="Product"
             Items="@@_products"
             AllowPaging="true"
             AutoGenerateRows="true"
             HeaderText="Browse Products"
             PageIndexChanged="HandlePageChanged" /&gt;</code></pre>

<hr />

<h3>Edit Button &amp; Mode Switching</h3>
<p>Set <code>AutoGenerateEditButton="true"</code> to add an Edit link in the command row.
   Clicking Edit switches the DetailsView to Edit mode. Click Update or Cancel to return to ReadOnly mode.
   Handle the <code>ModeChanging</code> and <code>ItemUpdating</code> events to integrate with your data store.</p>

<div data-audit-control="DetailsView-3">
<DetailsView ItemType="Product"
             Items="@_products"
             AllowPaging="true"
             AutoGenerateRows="true"
             AutoGenerateEditButton="true"
             HeaderText="Editable Product"
             GridLines="GridLines.Both"
             ModeChanging="HandleModeChanging"
             ItemUpdating="HandleUpdating" />
</div>

<p style="margin-top: 10px; font-weight: bold;">@_statusMessage</p>

<p>Code:</p>
<pre><code>&lt;DetailsView ItemType="Product"
             Items="@@_products"
             AllowPaging="true"
             AutoGenerateRows="true"
             AutoGenerateEditButton="true"
             HeaderText="Editable Product"
             ModeChanging="HandleModeChanging"
             ItemUpdating="HandleUpdating" /&gt;

@@code {
    void HandleModeChanging(DetailsViewModeEventArgs e)
    {
        // e.NewMode indicates the requested mode (Edit, ReadOnly, Insert)
    }

    void HandleUpdating(DetailsViewUpdateEventArgs e)
    {
        // Persist changes to your data store here
    }
}</code></pre>

<hr />

<h3>Empty Data</h3>
<p>When the data source has no items, the <code>EmptyDataText</code> is displayed.</p>

<div data-audit-control="DetailsView-4">
<DetailsView ItemType="Product"
             Items="@_emptyList"
             AutoGenerateRows="true"
             EmptyDataText="No products found."
             GridLines="GridLines.Both" />
</div>

<p>Code:</p>
<pre><code>&lt;DetailsView ItemType="Product"
             Items="@@_emptyList"
             EmptyDataText="No products found." /&gt;</code></pre>

@code {
    private string _statusMessage = "";
    private int _pageChangeCount = 0;

    private List<Product> _products = Product.GetProducts();

    private List<Product> _emptyList = new();

    private void HandlePageChanged(PageChangedEventArgs e)
    {
        _pageChangeCount++;
    }

    private void HandleModeChanging(DetailsViewModeEventArgs e)
    {
        _statusMessage = $"Mode changing to {e.NewMode}";
    }

    private void HandleUpdating(DetailsViewUpdateEventArgs e)
    {
        _statusMessage = "Update requested — integrate with your data store here.";
    }
}
