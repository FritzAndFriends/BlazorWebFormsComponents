# Colossus â€” History

## 2026-02-10: Initial integration test audit

- Audited all 74 sample page routes against existing smoke tests
- Added 32 missing smoke test `[InlineData]` entries in `ControlSampleTests.cs`
- Added 4 interaction tests for Sprint 2 components (MultiView, ChangePassword, CreateUserWizard, Localize)
- Fixed Calendar sample page CS1503 errors (bare enum values â†’ fully qualified `CalendarSelectionMode.X`)

## 2026-02-10: Sprint 3 â€” DetailsView and PasswordRecovery tests

- Added smoke test `[InlineData("/ControlSamples/DetailsView")]` under Data Controls in `ControlSampleTests.cs`
- Added smoke test `[InlineData("/ControlSamples/PasswordRecovery")]` under Login Controls in `ControlSampleTests.cs`
- Added 3 interaction tests for DetailsView in `InteractiveComponentTests.cs`:
  - `DetailsView_RendersTable_WithAutoGeneratedRows` â€” verifies table renders with field rows
  - `DetailsView_Paging_ChangesRecord` â€” verifies pager links navigate between records
  - `DetailsView_EditButton_SwitchesMode` â€” verifies Edit link switches to edit mode with Update/Cancel links
- Added 2 interaction tests for PasswordRecovery in `InteractiveComponentTests.cs`:
  - `PasswordRecovery_Step1Form_RendersUsernameInput` â€” verifies Step 1 username input and submit button render
  - `PasswordRecovery_UsernameSubmit_TransitionsToQuestionStep` â€” verifies username submission fires handler and transitions
- Build verified: 0 errors, 0 warnings
- Key learnings:
  - DetailsView sample has 3 sections: auto-generated rows, paging (with `PageIndexChanged` counter), and edit mode (with `ModeChanging`/`ItemUpdating` status message)
  - PasswordRecovery sample has 3 instances: default (with all 3 handlers), custom text, and help link. First instance has status message feedback via `_statusMessage`
  - DetailsView renders as `<table>` with `<tr>` rows per field â€” consistent with Web Forms output
  - PasswordRecovery Step 1 uses `input[type='text']` for username, button for submit

ðŸ“Œ Team update (2026-02-12): Sprint 3 gate review â€” DetailsView and PasswordRecovery APPROVED. 50/53 components (94%). Library effectively feature-complete. â€” decided by Forge

## 2026-02-12: Boy Scout rule â€” fixed 7 pre-existing integration test failures

Fixed all 7 failing integration tests. 111/111 passing after fixes.

### Failure 1 & 2: ChangePassword + CreateUserWizard form fields not found
- **Root cause:** The sample pages at `ChangePassword/Index.razor` and `CreateUserWizard/Index.razor` were MISSING `@using BlazorWebFormsComponents.LoginControls`. The components rendered as raw HTML custom elements (`<changepassword>`) instead of Blazor components. PasswordRecovery worked because it had the import.
- **Fix:** Added `@using BlazorWebFormsComponents.LoginControls` to both sample pages. Also updated test selectors from `input[type='password']` / `input[type='text']` to ID-based selectors (`input[id$='_CurrentPassword']`, etc.) with `WaitForAsync` for circuit establishment timing.

### Failure 3 & 4 & 7: Image, ImageMap external placeholder URLs unreachable
- **Root cause:** Sample pages referenced `https://via.placeholder.com/...` URLs which are unreachable in the test environment.
- **Fix:** Created 8 local SVG placeholder images in `wwwroot/img/` (placeholder-150x100.svg, placeholder-80x80.svg, etc.) and replaced all external URLs in both `Image/Index.razor` and `ImageMap/Index.razor`.

### Failure 4 (additional): ImageMap duplicate InlineData
- **Root cause:** ImageMap had entries in BOTH `EditorControl_Loads_WithoutErrors` and `NavigationControl_Loads_WithoutErrors`. Per team decisions, ImageMap is a Navigation Control.
- **Fix:** Removed `[InlineData("/ControlSamples/ImageMap")]` from EditorControl test theory.

### Failure 5: Calendar console errors
- **Root cause:** ASP.NET Core structured log messages (timestamps like `[2026-02-12T16:00:34.529...]`) forwarded to browser console as "error" level. Calendar component and sample page have NO bugs â€” these are benign framework messages from Blazor's SignalR circuit.
- **Fix:** Added regex filter in `VerifyPageLoadsWithoutErrors` to exclude messages matching `^\[\d{4}-\d{2}-\d{2}T` pattern.

### Failure 6: TreeView/Images broken image path
- **Root cause:** `ImageUrl="/img/C#.png"` but actual file is `CSharp.png`.
- **Fix:** Changed to `ImageUrl="/img/CSharp.png"`.

## Learnings

- **Missing @using is silent:** When a Blazor component can't be resolved, it renders as a raw HTML custom element with no error. This is extremely hard to catch without integration tests that verify actual DOM content.
- **LoginControls namespace:** Components in `BlazorWebFormsComponents.LoginControls` require an explicit `@using` â€” the root `@using BlazorWebFormsComponents` in `_Imports.razor` doesn't cover sub-namespaces. PasswordRecovery had it; ChangePassword and CreateUserWizard didn't.
- **ASP.NET Core log messages in browser console:** Blazor Server forwards structured log output to the browser console. These appear as "error" type messages starting with ISO 8601 timestamps. Tests must filter these to avoid false positives.
- **SVG placeholders:** Simple inline SVG files are ideal test-safe replacements for external placeholder image services. They're just XML text, always available, and don't require network access.

ðŸ“Œ Team update (2026-02-12): Boy scout fixes logged â€” 7 pre-existing integration test failures fixed, 111/111 integration tests + 797/797 bUnit tests all green. Commit a4d17f5 on sprint3/detailsview-passwordrecovery. â€” logged by Scribe

## 2026-02-12: DetailsView edit mode input textbox verification test

- Added `DetailsView_EditMode_RendersInputTextboxes` integration test in `InteractiveComponentTests.cs`
- Test verifies the full edit mode lifecycle:
  1. Navigates to `/ControlSamples/DetailsView` and clicks the Edit link
  2. Waits for "Mode changing" status message (Blazor Server DOM update)
  3. Asserts at least 3 `<input type="text">` elements appear (CustomerID, FirstName, LastName, CompanyName fields)
  4. Asserts Update and Cancel links are present via `GetByRole(AriaRole.Link, ...)`
  5. Clicks Cancel and verifies return to ReadOnly mode â€” no text inputs remain
- This test catches the known bug where edit mode shows command row changes (Editâ†’Update/Cancel) but leaves field values as plain text instead of rendering `<input type="text">` textboxes
- Cyclops is fixing the component in parallel â€” this test will pass once the fix lands
- Key selector: `input[type='text']` works because the fix uses raw HTML `<input type="text">` not Blazor's `<InputText>` (which omits `type="text"` in .NET 10)

ðŸ“Œ Team update (2026-02-12): DetailsView auto-generated fields must render <input type="text"> in Edit/Insert mode â€” decided by Cyclops
