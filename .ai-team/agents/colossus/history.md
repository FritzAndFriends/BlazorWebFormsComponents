# Colossus â€” History

## 2026-02-10: Initial integration test audit

- Audited all 74 sample page routes against existing smoke tests
- Added 32 missing smoke test `[InlineData]` entries in `ControlSampleTests.cs`
- Added 4 interaction tests for Sprint 2 components (MultiView, ChangePassword, CreateUserWizard, Localize)
- Fixed Calendar sample page CS1503 errors (bare enum values â†’ fully qualified `CalendarSelectionMode.X`)

## 2026-02-10: Sprint 3 â€” DetailsView and PasswordRecovery tests

- Added smoke test `[InlineData("/ControlSamples/DetailsView")]` under Data Controls in `ControlSampleTests.cs`
- Added smoke test `[InlineData("/ControlSamples/PasswordRecovery")]` under Login Controls in `ControlSampleTests.cs`
- Added 3 interaction tests for DetailsView in `InteractiveComponentTests.cs`:
  - `DetailsView_RendersTable_WithAutoGeneratedRows` â€” verifies table renders with field rows
  - `DetailsView_Paging_ChangesRecord` â€” verifies pager links navigate between records
  - `DetailsView_EditButton_SwitchesMode` â€” verifies Edit link switches to edit mode with Update/Cancel links
- Added 2 interaction tests for PasswordRecovery in `InteractiveComponentTests.cs`:
  - `PasswordRecovery_Step1Form_RendersUsernameInput` â€” verifies Step 1 username input and submit button render
  - `PasswordRecovery_UsernameSubmit_TransitionsToQuestionStep` â€” verifies username submission fires handler and transitions
- Build verified: 0 errors, 0 warnings
- Key learnings:
  - DetailsView sample has 3 sections: auto-generated rows, paging (with `PageIndexChanged` counter), and edit mode (with `ModeChanging`/`ItemUpdating` status message)
  - PasswordRecovery sample has 3 instances: default (with all 3 handlers), custom text, and help link. First instance has status message feedback via `_statusMessage`
  - DetailsView renders as `<table>` with `<tr>` rows per field â€” consistent with Web Forms output
  - PasswordRecovery Step 1 uses `input[type='text']` for username, button for submit

ðŸ“Œ Team update (2026-02-12): Sprint 3 gate review â€” DetailsView and PasswordRecovery APPROVED. 50/53 components (94%). Library effectively feature-complete. â€” decided by Forge

 Team update (2026-02-12): Milestone 4 planned  Chart component with Chart.js via JS interop. 8 work items, design review required before implementation.  decided by Forge + Squad

## Learnings

### 2026-02-12: Milestone 4 â€” Chart integration tests (WI-7)

- Added 8 Chart smoke tests as a dedicated `ChartControl_Loads_AndRendersContent` Theory in `ControlSampleTests.cs`
  - Follows the Menu pattern: separate Theory with its own verify method (`VerifyChartPageLoads`) that tolerates JS interop console errors but checks for page errors
  - Routes: `/ControlSamples/Chart`, `Chart/Line`, `Chart/Bar`, `Chart/Pie`, `Chart/Area`, `Chart/Doughnut`, `Chart/Scatter`, `Chart/StackedColumn`
- Added 4 interactive tests in `InteractiveComponentTests.cs`:
  - `Chart_DefaultPage_RendersCanvas` â€” verifies `<canvas>` on Column (default) page
  - `Chart_LinePage_RendersCanvas` â€” verifies `<canvas>` on Line page
  - `Chart_PiePage_RendersCanvas` â€” verifies `<canvas>` on Pie page
  - `Chart_AllTypes_RenderCanvas` â€” Theory test covering all 8 routes for `<canvas>` element
- All 19 Chart tests pass (8 smoke + 3 individual canvas + 8 theory canvas)
- Used `WaitUntilState.DOMContentLoaded` instead of `NetworkIdle` for Chart tests â€” Chart.js JS interop can keep network busy
- Key learnings:
  - Chart component renders `<div>` wrapping a `<canvas>` element (in `Chart.razor`), so `<canvas>` is always in the DOM even before Chart.js initializes
  - Chart pages use JS interop (`ChartJsInterop.cs`) â€” console errors are expected if Chart.js CDN/bundle isn't fully loaded; page errors are not
  - Pre-existing test suite has 97 failures on non-Chart tests due to ASP.NET structured log console errors (`[timestamp] Error:`) being caught by `Assert.Empty(consoleErrors)` â€” these are unrelated to Chart work

### 2026-02-12: Enhanced Chart visual appearance tests

- Added 5 stronger Chart tests in `InteractiveComponentTests.cs` to verify chart appearance:
  - `Chart_RendersCanvas_WithDimensions` â€” verifies canvas has non-zero width/height via BoundingBox
  - `Chart_AllTypes_HaveExpectedContainerDimensions` â€” Theory test verifying all 8 chart types have container dimensions matching ChartWidth/ChartHeight parameters (600x400 for most, 500x400 for Pie/Doughnut)
  - `Chart_ChartJsLibrary_IsInitialized` â€” verifies Chart.js global is loaded and has at least one chart instance via `Chart.instances`
  - `Chart_Line_MultipleSeries_RenderMultipleDatasets` â€” verifies Line chart's 2 series (NY/LA temps) produce 2 datasets via `Chart.instances[0].data.datasets.length`
  - `Chart_AllTypes_CanvasHasRenderingContext` â€” Theory test verifying all 8 chart types have a 2D rendering context
- Total Chart tests: 38 (8 smoke + 11 basic canvas + 19 enhanced visual)
- Build: 0 errors, 0 warnings
- Test patterns:
  - Use `LocatorWaitForOptions { State = WaitForSelectorState.Visible }` instead of `Expect()` (class doesn't inherit from `PageTest`)
  - Use `page.EvaluateAsync<T>` to query Chart.js internals (`Chart.instances`, dataset counts, etc.)
  - Use `BoundingBoxAsync()` to verify element dimensions
  - Allow Â±10px tolerance on dimension checks for border/padding differences


